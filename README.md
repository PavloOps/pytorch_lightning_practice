# üî• PyTorch Lightning ‚ö°Ô∏è: Sign MNIST Dataset Example  ü§ó 

[![python](https://img.shields.io/badge/Python-3.12-3776AB.svg?style=flat&logo=python&logoColor=white)](https://www.python.org)
![PyTorch Lightning](https://img.shields.io/badge/pytorch-lightning-blue.svg?logo=PyTorch%20Lightning)
[![pytorch](https://img.shields.io/badge/PyTorch-2.5.0-EE4C2C.svg?style=flat&logo=pytorch)](https://pytorch.org)


–í—ã –∫–æ–≥–¥–∞-–Ω–∏–±—É–¥—å —Å—á–∏—Ç–∞–ª–∏, —Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞ –Ω–∞–¥–æ —Å–≤–∞—è—Ç—å, —á—Ç–æ–±—ã –æ–±—É—á–∏—Ç—å –Ω–µ–π—Ä–æ–Ω–∫—É?)

–ê —è –≤–æ—Ç –ø–æ—Å—á–∏—Ç–∞–ª–∞, –∫–æ–≥–¥–∞ –ø–æ—Å—Ç—É–ø–∏–ª–∞ –Ω–∞ –∫—É—Ä—Å [ü§ñ –ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é ClearML –∏ Pytorch Lightning ‚ö°](https://stepik.org/course/214389?auth=login)

80 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞ –∑–∞–Ω–∏–º–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Ç—Ä–µ–π–Ω-–ª—É–ø :) –∞ –µ—â–µ —Å–æ–±—Ä–∞—Ç—å –Ω–∞–¥–æ –∑–∞–≥—Ä—É–∑—á–∏–∫–∞ –∏ —Ç–¥, –∏ —Ç–ø. 

–ö–∞–∫ —Å–µ–π—á–∞—Å –ø–æ–º–Ω—é —Å–≤–æ–π –∫—É—Ä—Å–∞—á –ø–æ "–í–≤–µ–¥–µ–Ω–∏—é –≤ –≥–ª—É–±–æ–∫–æ–µ –æ–±—É—á–µ–Ω–∏–µ" –≤ [–ù–ò–£ –í–®–≠](https://www.hse.ru/ma/mds/news/909801290.html) - —É –º–µ–Ω—è –±—ã–ª–æ –¥–≤–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã—Ö —Ü–∏–∫–ª–∞ - –º—ã —Ç—é–Ω–∏–ª–∏ –∏ –∫–æ–Ω–≤–æ–ª—é—à–∫—É, –∏ –±–µ—Ä—Ç–∞. –Ø —Ç–∞–º –µ—â–µ –∏ –æ—à–∏–±–∫—É –¥–æ–ø—É—Å—Ç–∏–ª–∞, –ø–æ–∫–∞ —Ü–∏–∫–ª –¥–µ–ª–∞–ª–∞: —Å—á–∏—Ç–∞–ª–∞ —Ç—Ä–µ–π–Ω –ª–æ—Å—Å –∫–∞–∂–¥—ã–π –±–∞—Ç—á, –∞ –≤–∞–ª-–ª–æ—Å—Å - –∫–∞–∂–¥—É—é —ç–ø–æ—Ö—É, —É–ø—Å, –Ω–æ –ø—Ä–æ–∫–∞—Ç–∏–ª –∫—É—Ä—Å–∞—á –Ω–∞ 10/10. –í–∏–¥–∏–º–æ —è –±—ã–ª–∞ –æ—á–µ–Ω—å —É–±–µ–¥–∏—Ç–µ–ª—å–Ω–∞, –Ω–æ –æ—à–∏–±–∫–∏ –Ω–∞–¥–æ –∏—Å–ø—Ä–∞–≤–ª—è—Ç—å, –∏–±–æ –ø—Ä–æ–¥ –∏ —É—á–µ–±–∞ - –æ—á–µ–Ω—å —Ä–∞–∑–Ω—ã–µ —Ç–µ–º—ã. –ê –µ—â–µ –Ω–µ–ª—å–∑—è –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è –Ω–∞ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–æ–º –ª—é–±–∏—Ç–µ–ª—å—Å–∫–æ–º —É—Ä–æ–≤–Ω–µ, –Ω—É–∂–Ω–æ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –Ω–∞ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–æ–¥ ü´°

–ü—Ä–∏—à–ª–æ—Å—å –Ω–µ–º–Ω–æ–≥–æ –ø–æ–ø–æ—Ç–µ—Ç—å, –Ω–æ –±—ã–ª–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ - –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —Ä–æ–¥–∏–ª—Å—è –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π, –ª–µ–≥–∫–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π —Å–∫—Ä–∏–ø—Ç (–∑–∞ —Ä–∞–∑–æ–º –∑–∞–±—ã–ª–∞ –∏ –ø—Ä–æ argparse, –∫–æ–≥–¥–∞ –ø–æ—Å–æ–≤–µ—Ç–æ–≤–∞–ª–∏ click)

–ò–∑ —è–≤–Ω—ã—Ö –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤ –¥–ª—è –º–µ–Ω—è:
- –∑–∞–ø—É—Å–∫ —Å –∫–æ–Ω—Å–æ–ª–∏
- —Ö—É–∫–∏
- –º–æ–¥—É–ª—å–Ω–æ—Å—Ç—å
- —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å, —É–º–µ–Ω—å—à–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
- –ª–µ–≥–∫–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å, –∏–∑–º–µ–Ω—è—è –∫–æ–Ω—Ñ–∏–≥
- –ø—Ä–æ–¥–∞–∫—à–Ω —Å—Ç–∞–π–ª, –¥–æ—Ä–æ–≥–æ-–±–æ–≥–∞—Ç–æ (–∑–∞—Ö–æ–¥–∏—Ç–µ –≤ –ø–∏—Ç–æ–Ω—è—á–∏–π —Å–∫—Ä–∏–ø—Ç, –∑–∞—Ü–µ–Ω–∏—Ç–µ) :)

–í–æ–æ–±—â–µ–º, –¥–∞—Ç–∞—Å–µ—Ç - –∞–º–µ—Ä–∏–∫–∞–Ω—Å–∫–∏–π —è–∑—ã–∫ –∂–µ—Å—Ç–æ–≤, –ø–æ—á–∏—Ç–∞—Ç—å –æ –Ω—ë–º –º–æ–∂–Ω–æ —Ç—É—Ç: [Sign MNIST Dataset](https://www.kaggle.com/datasets/datamunge/sign-language-mnist)

![alphabet.png](pics/alphabet.png)

–ê –≤–æ—Ç –∏ –ø—Ä–µ—Ç–µ–Ω–¥–µ–Ω—Ç –Ω–∞ —Ç–æ, —á—Ç–æ–±—ã –∫–ª–∞—Å—Å–Ω–æ –æ–±—É—á–∞—Ç—å—Å—è —Å –æ–±–≤—è–∑–∫–æ–π Pytorch Lightning :) –∫–æ–ª–±–∞—Å–∞-–∫–æ–Ω–≤–æ–ª—é—à–µ—á–∫–∞:

![pavloops_myconvnet_graph.png](pics/pavloops_myconvnet_graph.png)

–î–ª—è –µ—ë –æ–±—É—á–µ–Ω–∏—è —É–∂–µ –≤—Å—ë –≥–æ—Ç–æ–≤–æ, –ø–æ–º–Ω–∏—Ç–µ –∫–∞–∫ –≤ —Ä–µ–∫–ª–∞–º–µ? "–ü—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤—å –≤–æ–¥—ã", –Ω–æ –º—ã –¥–æ–±–∞–≤–∏–º –≤ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –ª–∏–±—ã –∏–∑ —Ñ–∞–π–ª–∏–∫–∞ requirements.txt:
```bash
pip install -r /path/to/requirements.txt
pip install lightning[extra]
```

–ï—Å–ª–∏ –µ—Å—Ç—å –Ω–µ–ø—Ä–µ–æ–¥–æ–ª–∏–º–æ–µ –∂–µ–ª–∞–Ω–∏–µ –ø–æ–¥–∫—Ä—É—Ç–∏—Ç—å –≥–∏–ø–µ—Ä—ã - —Å—Ç–∞–≤–∏–º —Å–≤–æ–∏ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –∫–æ–Ω—Ñ–∏–≥–∞—Ö —Å–∫—Ä–∏–ø—Ç–∞ (—è —É–≤–µ—Ä–µ–Ω–∞, —á—Ç–æ –≤ –±—É–¥—É—â–µ–º –∏—Ö –±—É–¥–µ—Ç –ø—ã–ª–µ—Å–æ—Å–∏—Ç—å –∫–ª–µ—Ä–º–ª, –Ω–æ –Ω–µ –±—É–¥–µ–º —Å–∏–ª—å–Ω–æ —Å–ø–æ–π–ª–µ—Ä–∏—Ç—å), –Ω–æ —Ç–∞–º —É–∂–µ –≤—Å–µ –Ω–æ—Ä–º.

## –ó–∞–ø—É—Å–∫–∞–µ–º :) 

### (–∫–æ–¥ —Å–¥–µ–ª–∞–Ω –ø–æ–¥ OS Linux, —É –º–µ–Ω—è –≤–∏–Ω–¥–∞ –¥–ª—è –∏–≥—Ä—É—à–µ—á–µ–∫, —Ä–∞–∑–¥–µ–ª—è—é –∏ –≤–ª–∞—Å—Ç–≤—É—é)

```bash
python pavloops_solution2.py --fast_dev_run
```

–û–ø–∞, –∞ —ç—Ç–æ —á—Ç–æ –∑–∞ —Ñ–ª–∞–≥ —Ç–∞–∫–æ–π "fast_dev_run"? –ï–≥–æ –º–æ–∂–Ω–æ –Ω–µ –∑–≤–∞—Ç—å, –Ω–æ... –≠—Ç–æ —Ç–æ, —á—Ç–æ —è–≤–ª—è–µ—Ç—Å—è —Ö–æ—Ä–æ—à–µ–π –ø—Ä–∞–∫—Ç–∏–∫–æ–π, –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ç–æ—á–∫—É –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, –≤—Å—ë –ª–∏ –∂–∏–≤–æ–µ –∏ –≥–æ—Ç–æ–≤–æ–µ –∫ –æ–±—É—á–µ–Ω–∏—é, –≤ –∫–æ–ø–∏–ª–∫—É, —Å–ø–∞—Å–∏–±–æ :)

–ö—É—Å—å:

```bash
[2025-Mar-06 14:21:01] INFO: –¢–µ—Å—Ç–æ–≤—ã–π –ø—Ä–æ–≥–æ–Ω —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ–π–¥–µ–Ω
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
[2025-Mar-06 14:21:02] INFO: Train file already downloaded.
[2025-Mar-06 14:21:02] INFO: Test file already downloaded.
[2025-Mar-06 14:21:04] INFO: Train is loaded to RAM.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name      | Type             | Params | Mode
-------------------------------------------------------
0 | block1    | Sequential       | 96     | train
1 | block2    | Sequential       | 1.2 K  | train
2 | lin1      | Linear           | 78.5 K | train
3 | act1      | LeakyReLU        | 0      | train
4 | drop1     | Dropout          | 0      | train
5 | lin2      | Linear           | 2.5 K  | train
6 | criterion | CrossEntropyLoss | 0      | train
-------------------------------------------------------
82.3 K    Trainable params
0         Non-trainable params
82.3 K    Total params
0.329     Total estimated model params size (MB)
15        Modules in train mode
0         Modules in eval mode
Epoch 19: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 215/215 [00:04<00:00, 47.43it/s, v_num=0, train/loss=0.237]`Trainer.fit` stopped: `max_epochs=20` reached.
Epoch 19: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 215/215 [00:04<00:00, 47.26it/s, v_num=0, train/loss=0.237]
Seed set to 2025
[2025-Mar-06 14:22:32] INFO: Test is loaded to RAM.
Fact: 21, Prediction: 21
[2025-Mar-06 14:22:33] INFO: Process finished successfully.
```

## –≠—Ç–æ —á–∏—Å—Ç—ã–π –≤–∏–Ω üéØüèÜ

–í–æ—Ç —Ç–∞–∫–æ–≥–æ –ø–æ–∫–∞–∂—É—Ç (–ø–æ –∏–¥–µ–µ, –≤ –ª–∞–π—Ç–Ω–∏–Ω–≥–µ –∂–µ –∏–º–ø–ª–µ–º–µ–Ω–∏—Ä–æ–≤–∞–Ω–∞ –¥–∞–∂–µ —Ñ—É–Ω–∫—Ü–∏—è "–∑–∞–∑–µ—Ä–Ω–∏ –≤—Å—ë, —á—Ç–æ –º–æ–∂–Ω–æ"):

![test_picture.png](pics/test_picture.png)

## –¢–∞–∫, –ø–æ–¥–æ–∂–¥–∏—Ç–µ

–í —Å–∫—Ä–∏–ø—Ç–µ 370 —Å—Ç—Ä–æ–∫, –∞–ª–ª–æ, –≥–¥–µ —É–ø—Ä–æ—â–µ–Ω–∏–µ, –≥–¥–µ –æ–¥–Ω–æ—Å—Ç—Ä–æ—á–Ω–∏–∫, —á—Ç–æ –∑–∞ —Ä–∞–∑–≤–æ–¥? –ü–æ –æ–ø—ã—Ç—É: 370 —Å—Ç—Ä–æ–∫ –≤ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ - —ç—Ç–æ –º–∞–ª–æ, –æ—Å–æ–±–µ–Ω–Ω–æ, –µ—Å–ª–∏ —ç—Ç–æ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ –æ–±–≤—è–∑–∞–Ω–æ –∏ —Ö–æ—Ä–æ—à–æ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ, –ø—Ä–∞–≤–¥–∞-–ø—Ä–∞–≤–¥–∞.

## –ß—Ç–æ –¥–∞–ª—å—à–µ?

–ö–æ–ª–ª–±—ç–∫–∏, –º–µ—Ç—Ä–∏–∫–∏ –Ω–µ –∑–∞–±—ã–ª–∞ –∏–∑ –≤—Ç–æ—Ä–æ–π —á–∞—Å—Ç–∏ –≤—Ç–æ—Ä–æ–π –ª–∞–±—ã?) –ó–∞–±—ã–ª–∞, –∏–¥–∏ –¥–µ–ª–∞–π :)
